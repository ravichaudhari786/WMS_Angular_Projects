<!-- <breadcrumb></breadcrumb> -->

<div fxLayout="row wrap" class="matero-row">

  <div fxFlex="100" class="matero-col">
    <mat-card>
      <mat-tab-group animationDuration="1ms" (selectedIndexChange)="tabInwardchange($event)" [(selectedIndex)]="tab">
        <mat-tab label="Inward">
          <!-- (ngSubmit)="onSubmit(form)" -->
          <form [formGroup]="form">
            <div class="col-md-12">
              <div class="row pt-2">
                <div class="col-sm-6 col-md-6">
                  <div class="form-group">
                    <label>Customer Name</label>
                    <select class="form-control form-control-sm" (change)="GetCustomerID($event)"
                      formControlName="customer_id" id="customer_id">
                      <option value="null" disabled>Select</option>
                      <option *ngFor="let c of customerList" value={{c.CustomerID}}>{{c.CustomerName}}</option>
                    </select>
                    <mat-error id="customer_id_error"></mat-error>
                  </div>
                  <!-- /.form-group -->
                </div>

                <div class="col-sm-2 col-md-2">
                  <div class="form-group">
                    <label>Challan No.</label>
                    <input type="text" formControlName="challan_no" id="challan_no"
                      [ngClass]="{ 'is-invalid': submitted && f.challan_no.errors }"
                      class=" form-control form-control-sm" autocomplete="off" />

                  </div>
                  <!-- /.form-group -->
                </div>
                <!-- /.col -->
                <div class="col-sm-2 col-md-2">
                  <div class="form-group">
                    <button (click)="OnApplyClick(f.customer_id.value,f.challan_no.value)"
                      class="btn btn-secondary btn-sm" style="width: 100% !important; margin-top: 20px !important;">
                      Apply </button>
                  </div>
                </div>

                <div class="col-sm-2 col-md-2">
                  <div class="form-group">
                    <button (click)="onCustomerContact(CustomerContactcontent)" class="btn btn-secondary btn-sm"
                      style="width: 100% !important; margin-top: 20px !important;"> Contact </button>
                  </div>
                </div>
                <div class="col-sm-6 col-md-3">
                  <div class="form-group">
                    <label>Dock Name</label>
                    <select class="form-control form-control-sm" formControlName="dock_name" id="dock_name">
                      <option value="null" disabled>Select </option>
                      <option *ngFor="let d of dockList" value={{d.DockID}}>{{d.DockName}}</option>
                    </select>
                  </div>
                  <!-- /.form-group -->
                </div>

                <div class="col-sm-6 col-md-3">
                  <div class="form-group">
                    <label>Inward Date</label>
                    <input type="datetime-local" formControlName="inward_date" id="inward_date"
                      class="form-control form-control-sm" placeholder="yyyy-MM-dd"
                      [ngModel]="todayDate| date:'yyyy-MM-dd hh:mm:ss'" name="inward_date"
                      class="form-control form-control-rounded" />
                  </div>
                  <!-- /.form-group -->
                </div>
                <div class="col-sm-6 col-md-3">
                  <div class="form-group">
                    <label>Unloading By</label>
                    <select class="form-control form-control-sm" formControlName="unloading_by" id="unloading_by">
                      <option value="null" disabled>Select </option>
                      <option *ngFor="let u of unloadingList" value={{u.UserID}}>{{u.UserName}}</option>
                    </select>
                  </div>
                  <!-- /.form-group -->
                </div>

                <div class="col-sm-6 col-md-3">
                  <div class="form-group">
                    <label>Remarks</label>
                    <select class="form-control form-control-sm" formControlName="custremarks" id="custremarks"
                      (change)="GetMainRemarks($event)" *ngIf="mainRem1">
                      <option value="null" disabled>Select </option>
                      <option *ngFor="let r of remarkList" value={{r.Remarks}}>{{r.Remarks}}</option>
                    </select>

                    <input type="text" class="form-control form-control-sm" formControlName="Maincustremarks"
                      id="Maincustremarks" *ngIf="mainRem2" />
                  </div>
                  <!-- /.form-group -->
                </div>
              </div>
              <hr>

              <div class="col-12">
                <p class="font-weight-bold">Transporter Details </p>
                <div class="row">
                  <div class="col">
                    <div class="row">
                      <div class="col-sm-6 col-md-3">
                        <div class="form-group">
                          <label>Transporter Name</label>
                          <input type="text" formControlName="transportername" id="transportername"
                            class=" form-control form-control-sm" placeholder="" autocomplete="on" />
                        </div>
                        <!-- /.form-group -->
                      </div>

                      <div class="col-sm-6 col-md-3">
                        <div class="form-group">
                          <label>Truck No</label>
                          <input type="text" formControlName="truckno" id="truckno"
                            class=" form-control form-control-sm" placeholder="" autocomplete="on" />
                        </div>
                        <!-- /.form-group -->
                      </div>
                      <!-- /.col -->
                      <div class="col-sm-6 col-md-3">
                        <div class="form-group">
                          <label>Container No</label>
                          <input type="text" formControlName="container_no" id="container_no"
                            class=" form-control form-control-sm" placeholder="" autocomplete="on" />
                        </div>
                        <!-- /.form-group -->
                      </div>

                      <div class="col-sm-6 col-md-3">
                        <div class="form-group">
                          <button (click)="OnTransportAdd(TranspoterDetailcontent)" class="btn btn-secondary btn-sm"
                            style="width: 85px !important; margin-top: 20px !important;"> Add </button>
                        </div>
                      </div>
                    </div>
                  </div>

                 

                </div>
              </div>
              <hr>
              <div class="col-12">
                <p class="font-weight-bold"> Inward Details </p>
                <div class="row">
                  <div class="col-9">
                    <div class="row">
                      <div class="col-sm-4 col-md-4">
                        <div class="form-group">
                          <label>Product Name</label>
                          <select class="form-control form-control-sm" (change)="OnProductSelect($event)"
                            formControlName="product_id" id="product_id">
                            <option value="null" disabled>Select </option>
                            <option *ngFor="let p of productList" value="{{p.ProductID}}">{{p.ProductName}}</option>
                          </select>
                        </div>
                      </div>

                      <div class="col-sm-4 col-md-4">
                        <div class="form-group">
                          <label>Brand Name </label>
                          <select class="form-control form-control-sm" (change)="OnBrandSelect($event)"
                            formControlName="brand_id" id="brand_id">
                            <option value="null" disabled>Select </option>
                            <option *ngFor="let b of brandList" value="{{b.BrandID}}">{{b.BrandName}}</option>
                          </select>
                        </div>
                        <!-- [(ngModel)]="selectedBrand" -->
                        <!-- /.form-group [ngValue]="b"-->
                      </div>
                      <!-- /.col -->
                      <div class="col-sm-4 col-md-4">
                        <div class="form-group">
                          <label>Count In Packet</label>
                          <select class="form-control form-control-sm" formControlName="packetcount" id="packetcount">
                            <option value="null" disabled>Select </option>
                            <option *ngFor="let c of packateCountList" value={{c.Counts}}>{{c.Counts}}</option>
                          </select>
                        </div>
                        <!-- /.form-group -->
                      </div>
                      <div class="col-sm-4 col-md-4">
                        <div class="form-group">
                          <label>Quantity</label>
                          <input type="text" formControlName="quantity" id="quantity" autocomplete="off"
                            class="form-control form-control-sm" placeholder="" required />
                        </div>

                        <!-- /.form-group -->
                      </div>

                      <div class="col-sm-4 col-md-4">
                        <div class="form-group">
                          <label>Service Type</label>
                          <select class="form-control form-control-sm" (change)="OnServiceSelect($event)"
                            formControlName="service_id" id="service_id">
                            <option [ngValue]="null" disabled>Select </option>
                            <option *ngFor="let s of serviceTypeList" value="{{s.StorageAreaTypeID}}">{{s.ServiceName}}
                            </option>
                          </select>
                        </div>
                        <!-- /.form-group -->
                      </div>
                      <!-- /.col -->
                      <div class="col-sm-4 col-md-4">
                        <div class="form-group">
                          <label>Self Life</label>
                          <input type="text" formControlName="selflife" id="selflife"
                            class="form-control form-control-sm" placeholder="" />
                        </div>
                        <!-- /.form-group -->
                      </div>
                      <div class="col-sm-4 col-md-4">
                        <div class="form-group">
                          <label>Mfg Date</label>
                          <input type="date" formControlName="mgfdate" id="mgfdate" class="form-control form-control-sm"
                            placeholder="" />
                        </div>

                        <!-- /.form-group -->
                      </div>

                      <div class="col-sm-4 col-md-4">
                        <div class="form-group">
                          <label>Expiry Date</label>
                          <input type="date" formControlName="expdate" id="expdate" class="form-control form-control-sm"
                            placeholder="" />
                        </div>

                        <!-- /.form-group -->
                      </div>
                      <!-- /.col -->
                      <div class="col-sm-4 col-md-4">
                        <div class="form-group">
                          <label>Labour Contracter</label>
                          <select class=" form-control form-control-sm" (change)="OnLabourSelect($event)"
                            formControlName="labourcontractor_id" id="labourcontractor_id">
                            <option [ngValue]="null" disabled>Select </option>
                            <option *ngFor="let l of labourContractorList" value="{{l.LabourContractorID}}">
                              {{l.ContractorName}}</option>
                          </select>
                        </div>
                      </div>
                      <div class="col-sm-3 col-md-3">
                        <div class="form-group">
                          <label>Lot No</label>
                          <input type="text" formControlName="lot_no" id="lot_no" class=" form-control form-control-sm"
                            [(ngModel)]="CurrentLotNo" placeholder="" readonly />
                        </div>
                      </div>

                      <div class="col-sm-3 col-md-3">
                        <div class="form-group">
                          <label>Remarks</label>
                          <select class="form-control form-control-sm" formControlName="remarks" id="remarks">
                            <option [ngValue]="null" disabled>Select </option>
                            <option *ngFor="let r of remarkList" [ngValue]="r">{{r.Remarks}}</option>
                          </select>
                        </div>

                        <!-- /.form-group -->
                      </div>
                      <!-- /.col -->
                      <div class="col-sm-3 col-md-3">
                        <div class="form-group">
                          <label>Country</label>
                          <input type="text" formControlName="country" id="country" class="form-control form-control-sm"
                            placeholder="" autocomplete="off" />
                        </div>
                      </div>

                      <div class="col-sm-3 col-md-3">
                        <div class="form-group">
                          <label>Class</label>
                          <select class="form-control form-control-sm" formControlName="cbClassName" id="cbClassName">
                            <option value="null" disabled>Select </option>
                            <option *ngFor="let i of ClassMasterList" value={{i.ClassName}}>
                              {{i.ClassName}}
                            </option>
                          </select>
                        </div>
                      </div>

                      <!--<div class="testclass">
                          <div class="form-group">
                            <label>Test</label><br>
                              <mat-form-field appearance="outline" >                                
                                <input matInput type="text" placeholder="0" id="end_time_hour" />
                                <mat-select class="form-control form-control-sm" formControlName="test1" id="test1"  >
                                  <mat-option *ngFor="let Sr of storageAreaList" value="r">{{Sr.StorageArea}}</mat-option>
                                </mat-select>                                
                              </mat-form-field>
                          </div>                          
                        </div>-->
                      <!-- /.form-group -->

                      <div class="col-3">
                        <div class="form-group">
                          <button (click)="OnAddClick()" class="btn btn-secondary btn-sm" [id]="OnAddClick"
                            [disabled]="OnAddProductClick" style="width: 85px !important; margin-top: 20px !important;">
                            Add </button>
                        </div>

                        <!-- /.form-group -->
                      </div>

                      <div class="col-3">
                        <div class="form-group">
                          <button (click)="openStorageArea(StorageAreacontent)" class="btn btn-secondary btn-sm"
                            id="BtnStorageArea" style="width: 100px !important; margin-top: 20px !important;"> Storage
                            Area </button>
                        </div>

                        <!-- /.form-group -->
                      </div>
                      <!-- /.col -->
                      <div class="col-3">
                        <div class="form-group">
                          <button class="btn btn-secondary btn-sm"
                            style="width: 100px !important; margin-top: 20px !important;"> Label Print </button>
                        </div>
                      </div>

                      <!-- /.form-group -->
                      <div class="col-3">
                        <div class="form-group">
                          <button class="btn btn-secondary btn-sm"
                            style="width: 105px !important; margin-top: 20px !important;"> Receipt Print </button>
                        </div>
                      </div>
                      <!-- /.form-group -->
                    </div>
                  </div>
                  <div class="col-3">
                    <div class="card">
                      <ag-grid-angular style="height: 300px;" class="ag-theme-alpine" [rowData]="inwardservicelist"
                        [columnDefs]="serviceColumns">
                      </ag-grid-angular>

                    </div>
                  </div>

                </div>
                <!----popup-->
                <ng-template #StorageAreacontent let-c="close" let-d="dismiss">
                  <!-- <mat-tab-group>
                    <mat-tab label="Storage Area">  -->
                  <div class="modal-header">
                    <h4 id="modal-basic-title">Storage Area</h4>
                  </div>
                  <br>
                  <div class="row">
                    <div class="col-6">
                      <label>Quantity </label>
                      <input formControlName="quantity" id="quantity" readonly style="width: 50%;" />
                    </div>
                    <div class="col-6">
                      <label>AllocatedQty</label>
                      <input formControlName="allocatedQty" id="allocatedQty" readonly style="width: 50%;" />
                    </div>
                  </div>
                  <div class="modal-body">
                    <ag-grid-angular #LocationGrid style="height: 300px;" class="ag-theme-alpine"
                      [rowData]="storageAreaList" [columnDefs]="columnDefs" (cellValueChanged)="onCellKeyPress($event)">
                    </ag-grid-angular>
                    <!-- (cellValueChanged)="onCellValueChangedStorageArea($event)" [groupIncludeTotalFooter]="true"   (cellKeyPress)="onCellKeyPress($event)"
                          (rowClicked)="onRowClickStorageArea($event)" -->
                  </div>

                  <!-- </mat-tab> -->
                  <!-- <mat-tab label="Applied Storage Area"> 
                    <ag-grid-angular 
                          style="height: 300px;"
                          class="ag-theme-alpine"
                          [rowData]="InwardshowStorageArea"
                          [columnDefs]="AppliedStoragecolumnDefs"                        
                          [enableCellChangeFlash]="true"
                      >
                      </ag-grid-angular>
                    </mat-tab> -->
                  <!-- </mat-tab-group> -->
                  <div class="modal-footer">
                    <button type="button" class="btn btn-outline-dark"
                      (click)="onSaveStorageArea(StorageAreacontent)">ADD</button>
                    <button type="button" class="btn btn-info"
                      (click)="oncloseStoragearea(StorageAreacontent)">cancel</button>
                  </div>
                </ng-template>

                <!----popup customer contact-->
                <ng-template #CustomerContactcontent let-c="close" let-d="dismiss">
                  <div class="modal-header">
                    <h4 id="modal-basic-title">Customer Contact</h4>
                  </div>
                  <div class="modal-body">
                    <ag-grid-angular style="height: 300px;" class="ag-theme-alpine" [rowData]="customercontactList"
                      [columnDefs]="CustomerContactcolumnDefs" rowSelection="multiple" [groupIncludeTotalFooter]="true">
                    </ag-grid-angular>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-info"
                      (click)="onCloseCustomerContact(CustomerContactcontent)">cancel</button>
                  </div>
                </ng-template>
                <!-- ----------Tranfer detail------------ -->
                <!----popup customer contact-->
                <ng-template #TranspoterDetailcontent let-c="close" let-d="dismiss" style="width:620px;">
                  <div class="modal-header">
                    <h4 id="modal-basic-title">Transporter Details</h4>
                    <button type="button" class="btn btn-secondary btn-lg"
                      (click)="onAddTranspoterDetailNewrow()">+</button>
                  </div>
                  <div class="modal-body">
                    <ag-grid-angular style="height: 300px;" class="ag-theme-alpine" [rowData]="TransportList"
                      [columnDefs]="TransperdetailcolumnDefs" (rowClicked)="onRowSelectedTransport($event)">
                    </ag-grid-angular>
                  </div>
                  <div class="modalfooter">
                    <button type="button" style=" float: left; width:60px;" class="btn btn-danger"
                      (click)="onRemoveTranspoterDetailNewrow()">-</button>
                    <button type="button" style="float: right; width: 100px;" class="btn btn-info"
                      (click)="onCloseTransportContact(TranspoterDetailcontent)">Cancel</button>
                  </div>
                </ng-template>
              </div>
              <hr>
              <div class="col-12">
                <p class="font-weight-bold"> Inward Details List </p>

                <mtx-grid [data]="InwardDetailList" #gridlist [columns]="InwardDetailColumns" [loading]="false"
                  [columnResizable]="false" [multiSelectable]="false" [rowSelectable]="false"
                  [hideRowSelectionCheckbox]="false" [rowHover]="true" [rowStriped]="false" [showToolbar]="false"
                  [toolbarTitle]="'Detail List'" [columnHideable]="false" [columnMovable]="true" [expandable]="false"
                  [pageOnFront]="true" [showPaginator]="false" [pageSizeOptions]="[10,20,50,100,500]" [pageIndex]="0"
                  (dblclick)="onRowDblclicked(gridlist,$event)" [rowClassFormatter]="rowClassFormatterDetail">
                </mtx-grid>

                <!--[rowClassFormatter]="InwardDetailRows"(dblclick)="onRowDblclicked(gridlist,$event)" [toolbarTemplate]="toolbarTpl" [rowClassFormatter]="rowClassFormatter" -->
              </div>
              <hr>
              <div class="row">
                <div class="col-md-2 col-sm-2">
                  <button class="btn btn-secondary btn-sm" (click)="OnSaveinward()" style="width: 85px !important; "
                    [disabled]="click">Save</button>
                </div>
                <div class="col-md-2 col-sm-2">
                  <button class="btn btn-secondary btn-sm" (click)="OnResetInward()"
                    style="width: 85px !important; ">Reset</button>
                </div>
              
              </div>
            </div>
            <!--/.row-->

          </form>

        </mat-tab>

        <mat-tab label="Inward List">
          <div class="col-md-2 col-sm-2" style="padding: 5px 0px 6px;">
            <button class="btn btn-secondary btn-sm" (click)="OnListInward()"
              style="width: 150px !important; ">Refresh List</button>
          </div>
          <div style="height: 100%; box-sizing: border-box;">
            <ag-grid-angular style="height: 450px;" class="ag-theme-alpine" [rowData]="InwardList"
              [columnDefs]="columnsInwardList" [frameworkComponents]="frameworkComponents">
            </ag-grid-angular>
          </div>
        </mat-tab>
      </mat-tab-group>
    </mat-card>
  </div>


</div>